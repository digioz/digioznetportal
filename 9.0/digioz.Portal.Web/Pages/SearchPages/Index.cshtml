@page
@model digioz.Portal.Pages.SearchPages.IndexModel
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
@addTagHelper *, LazZiya.TagHelpers
@{
    ViewData["Title"] = "Search Results";
}

@if (Model.Items != null && Model.Items.Count > 0)
{
    <div class="mb-3">
        <strong>Search Scope:</strong> <span class="badge bg-primary">@Model.searchScope</span>
        @if (!string.IsNullOrWhiteSpace(Model.searchString))
        {
            <span class="ms-2"><strong>Search Term:</strong> "@Model.searchString"</span>
        }
    </div>
    
    @if (Model.HasLargeResultSet && Model.searchScope == "All")
    {
        <div class="alert alert-info mb-3">
            <i class="bi bi-info-circle"></i>
            <strong>Large Result Set:</strong> Your search returned a very large number of results. 
            For better performance and more precise results, consider:
            <ul class="mb-0 mt-2">
                <li>Using the search scope dropdown to narrow your search to specific content types</li>
                <li>Adding more specific search terms</li>
            </ul>
        </div>
    }
    
    <ul class="list-group list-group-flush">
    @foreach (var item in Model.Items)
    {
        <li class="list-group-item">
            <div class="d-flex justify-content-between align-items-start">
                <h5 class="mb-1">@Html.Raw(item.TitleHtml)</h5>
                @if (!string.IsNullOrEmpty(item.ContentType))
                {
                    <span class="badge bg-secondary">@item.ContentType</span>
                }
            </div>
            <p class="mb-1 text-muted">@Html.Raw(item.SnippetHtml)</p>
            @if (!string.IsNullOrEmpty(item.Url))
            {
                <a class="small" href="@item.Url">View Details</a>
            }
        </li>
    }
    </ul>
}
else if (!string.IsNullOrWhiteSpace(Model.searchString))
{
    <div class="alert alert-warning mb-0">
        <strong>No results found</strong> for "@Model.searchString" in <strong>@Model.searchScope</strong>.
    </div>
}
else
{
    <div class="text-muted">Enter a term to search.</div>
}

<div class="card-footer d-flex justify-content-between align-items-center">
    <small class="text-muted">Page @Model.pageNumber of @((int)Math.Ceiling((double)Model.TotalCount / Math.Max(1, Model.pageSize))) (@Model.TotalCount total)</small>
    <paging total-records="@Model.TotalCount"
            page-no="@Model.pageNumber"
            page-size="@Model.pageSize"
            show-prev-next="true"
            show-first-last="true"
            query-string-key-page-no="pageNumber"
            class="pagination mb-0">
        <route-values>
            <rv key="searchString" value="@Model.searchString"></rv>
            <rv key="searchScope" value="@Model.searchScope"></rv>
            <rv key="pageSize" value="@Model.pageSize"></rv>
        </route-values>
    </paging>
</div>
