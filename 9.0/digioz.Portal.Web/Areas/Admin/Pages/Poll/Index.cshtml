@page
@model digioz.Portal.Web.Areas.Admin.Pages.Poll.IndexModel
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
@{
    ViewBag.Title = "Poll";
    Layout = "/Areas/Admin/Pages/Shared/_LayoutAdmin.cshtml";
}

<h1 class="mt-4">Polls</h1>
<ol class="breadcrumb mb-4">
    <li class="breadcrumb-item">Admin</li>
    <li class="breadcrumb-item active">Poll</li>
</ol>
<div class="mb-3">
    <a class="btn btn-primary" asp-page="Add">
        <i class="bi bi-plus-circle"></i> Add Poll
    </a>
    <a class="btn btn-secondary" asp-page="../PollAnswer/Index">
        <i class="bi bi-list-ul"></i> Manage Answers
    </a>
</div>

<div class="table-responsive">
    <table class="table table-striped table-bordered table-sm align-middle">
        <thead>
            <tr>
                <th>Slug</th>
                <th>Featured</th>
                <th>Closed</th>
                <th>Allow Multiple</th>
                <th style="width:80px" class="text-center">Visible</th>
                <th style="width:80px" class="text-center">Approved</th>
                <th>Date Created</th>
                <th style="width:200px" class="text-end">Actions</th>
            </tr>
        </thead>
        <tbody>
        @foreach (var item in Model.Items)
        {
            <tr>
                <td>@item.Slug</td>
                <td>@(item.Featured ? "Yes" : "No")</td>
                <td>@(item.IsClosed ? "Yes" : "No")</td>
                <td>@(item.AllowMultipleOptionsVote ? "Yes" : "No")</td>
                <td class="text-center">
                    <form method="post" asp-page-handler="ToggleVisible" asp-route-id="@item.Id" class="d-inline">
                        @Html.AntiForgeryToken()
                        <button type="submit" class="btn btn-sm @(item.Visible == true ? "btn-success" : "btn-secondary")" title="Click to toggle">
                            <i class="bi bi-@(item.Visible == true ? "check-circle" : "x-circle")"></i>
                        </button>
                    </form>
                </td>
                <td class="text-center">
                    <form method="post" asp-page-handler="ToggleApproved" asp-route-id="@item.Id" class="d-inline">
                        @Html.AntiForgeryToken()
                        <button type="submit" class="btn btn-sm @(item.Approved == true ? "btn-success" : "btn-secondary")" title="Click to toggle">
                            <i class="bi bi-@(item.Approved == true ? "check-circle" : "x-circle")"></i>
                        </button>
                    </form>
                </td>
                <td>@item.DateCreated.ToString("yyyy-MM-dd HH:mm")</td>
                <td class="text-end">
                    <a class="btn btn-sm btn-info" asp-page="Details" asp-route-id="@item.Id" title="View Details">
                        <i class="bi bi-eye"></i>
                    </a>
                    <a class="btn btn-sm btn-primary" asp-page="Edit" asp-route-id="@item.Id" title="Edit">
                        <i class="bi bi-pencil"></i>
                    </a>
                    <a class="btn btn-sm btn-danger" asp-page="Delete" asp-route-id="@item.Id" title="Delete">
                        <i class="bi bi-trash"></i>
                    </a>
                    <a class="btn btn-sm btn-secondary" asp-page="../PollAnswer/Index" asp-route-PollId="@item.Id" title="Manage Answers">
                        <i class="bi bi-list-check"></i>
                    </a>
                </td>
            </tr>
        }
        </tbody>
    </table>
</div>

<nav>
    <ul class="pagination">
        <li class="page-item @(Model.pageNumber <= 1 ? "disabled" : "")">
            <a class="page-link" asp-page="Index" asp-route-pageNumber="@(Model.pageNumber - 1)" asp-route-pageSize="@Model.pageSize">Previous</a>
        </li>
        <li class="page-item disabled"><span class="page-link">Page @Model.pageNumber of @Model.TotalPages</span></li>
        <li class="page-item @(Model.pageNumber >= Model.TotalPages ? "disabled" : "")">
            <a class="page-link" asp-page="Index" asp-route-pageNumber="@(Model.pageNumber + 1)" asp-route-pageSize="@Model.pageSize">Next</a>
        </li>
    </ul>
</nav>
